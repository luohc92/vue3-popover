(function(p,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],o):(p=typeof globalThis<"u"?globalThis:p||self,o(p.Vue3Popover={},p.Vue))})(this,function(p,o){"use strict";const M={class:"popover-wrapper"},O={class:"popover-content"},V={key:0,class:"popover-title"},$=o.defineComponent({__name:"Popover",props:{placement:String,width:{type:[String,Number],default:200},title:String,content:String,zIndex:{type:Number,default:1999},trigger:{type:String,default:"click"},popperClass:String,appendTo:{type:String,default:"body"},darkMode:Boolean,disabled:Boolean},emits:["open","close"],setup(s,{emit:S}){const n=s,_=a=>typeof a=="number",h=o.ref(!1),x=()=>{h.value=!0,X("open")},P=()=>{h.value=!1,b.value=!1,r.value=n.placement||"bottom",X("close")},B=["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],g=o.ref(),c=o.ref(),t=o.ref(),y=o.ref(null),r=o.ref(n.placement||"bottom"),X=S,L=()=>{if(!c.value||!t.value)return;const a=c.value.getBoundingClientRect(),e=window.innerHeight,l=window.innerWidth,i=a.top-t.value.height-10,T=a.bottom+10,C=a.left-t.value.width-10,R=a.right+10,u=k=>{if(!k)return"bottom";const f=a.top<t.value.height,v=a.right+t.value.width>l,m=a.bottom+t.value.height>e,w=a.left<0;switch(k){case"top":if(f)return"bottom";if(w)return"top-end";if(v)return"top-start";break;case"top-start":if(f)return"bottom-start";if(w)return"top-end";break;case"top-end":if(f)return"bottom-end";if(v)return"top-start";break;case"bottom":if(m)return"top";if(w)return"bottom-end";if(v)return"bottom-start";break;case"bottom-start":if(m)return"top-start";if(w||v)return"bottom-end";break;case"bottom-end":if(m)return"top-end";if(w)return"bottom-start";break;case"left":if(w)return"right";if(f)return"left-start";if(m)return"left-end";break;case"left-start":if(w)return"right-start";if(m)return"top-start";break;case"left-end":if(w)return"right-end";if(f)return"left-start";break;case"right":if(v)return"left";if(f)return"right-start";if(m)return"right-end";break;case"right-start":if(v)return"left-start";if(m)return"top-start";break;case"right-end":if(v)return"left-end";if(f)return"right-start";break}return k};switch(r.value){case"top":i<0?r.value="bottom":r.value=u(r.value);break;case"bottom":T+t.value.height>e?r.value="top":r.value=u(r.value);break;case"left":const k=u(r.value);k!==r.value?r.value=k:C<0&&(r.value="right");break;case"right":const f=u(r.value);f!==r.value?r.value=f:R+t.value.width>l&&(r.value="left");break;case"top-start":i<0?r.value="bottom-start":r.value=u(r.value);break;case"top-end":i<0?r.value="bottom-end":r.value=u(r.value);break;case"bottom-start":T+t.value.height>e?r.value="top-start":r.value=u(r.value);break;case"bottom-end":T+t.value.height>e?r.value="top-end":r.value=u(r.value);break;case"left-start":C<0?r.value="right-start":r.value=u(r.value);break;case"left-end":C<0?r.value="right-end":r.value=u(r.value);break;case"right-start":R+t.value.width>l?r.value="left-start":r.value=u(r.value);break;case"right-end":const v=u(r.value);v!==r.value?r.value=v:R+t.value.width>l&&(r.value="left-end");break}},Y=()=>{g.value&&(t.value=g.value.getBoundingClientRect(),L())};o.watch(()=>n.placement,a=>{a&&B.includes(a)&&(r.value=a)},{immediate:!0}),o.watch(()=>h.value,a=>{!a||o.nextTick(()=>{Y()})});const D=()=>{n.trigger!=="click"||n.disabled||(h.value?P():x())},d=o.ref(),H=()=>{n.trigger!=="hover"||n.disabled||(d.value&&clearTimeout(d.value),b.value=!1,x())},b=o.ref(!1),j=()=>{n.trigger!=="hover"||n.disabled||(d.value&&clearTimeout(d.value),d.value=setTimeout(()=>{b.value||P()},300))},W=()=>{n.trigger!=="hover"||n.disabled||(b.value=!1,d.value&&clearTimeout(d.value),d.value=setTimeout(()=>{b.value||P()},300))},q=()=>{b.value=!0,d.value&&clearTimeout(d.value)},A=o.computed(()=>{if(!c.value||!t.value)return{};const a=c.value.getBoundingClientRect();let e=0,l=0,i=r.value;switch(B.includes(i)||(i="bottom"),i){case"left":e=t.value.width-5,l=t.value.height/2-5;break;case"left-start":e=t.value.width-5,l=a.height/2-5;break;case"left-end":e=t.value.width-5,l=t.value.height-a.height/2-5;break;case"right":e=-5,l=t.value.height/2-5;break;case"right-start":e=-5,l=a.height/2-5;break;case"right-end":e=-5,l=t.value.height-a.height/2-5;break;case"top":e=t.value.width/2-5,l=t.value.height-5;break;case"top-start":e=a.width/2-5,l=t.value.height-5;break;case"top-end":e=t.value.width-a.width/2-5,l=t.value.height-5;break;case"bottom":e=t.value.width/2-5,l=-5;break;case"bottom-start":e=a.width/2-5,l=-5;break;case"bottom-end":e=t.value.width-a.width/2-5,l=-5;break}return l>t.value.height&&(l=t.value.height-20),e>t.value.width&&(e=t.value.width-20),{left:`${e}px`,top:`${l}px`}}),U=o.computed(()=>{if(!c.value||!t.value)return{};let a=r.value;B.includes(a)||(a="bottom");const e=c.value.getBoundingClientRect();let l=0,i=0;switch(a){case"left":l=e.top-t.value.height/2+e.height/2+window.scrollY,i=e.left-t.value.width-10+window.scrollX;break;case"left-start":l=e.top+window.scrollY,i=e.left-t.value.width-10+window.scrollX;break;case"left-end":l=e.top-t.value.height+e.height+window.scrollY,i=e.left-t.value.width-10+window.scrollX;break;case"right":l=e.top-t.value.height/2+e.height/2+window.scrollY,i=e.left+e.width+10+window.scrollX;break;case"right-start":l=e.top+window.scrollY,i=e.left+e.width+10+window.scrollX;break;case"right-end":l=e.top-t.value.height+e.height+window.scrollY,i=e.left+e.width+10+window.scrollX;break;case"top":l=e.top-t.value.height-10+window.scrollY,i=e.left-t.value.width/2+e.width/2+window.scrollX;break;case"top-start":l=e.top-t.value.height-10+window.scrollY,i=e.left+window.scrollX;break;case"top-end":l=e.top-t.value.height-10+window.scrollY,i=e.left+e.width-t.value.width+window.scrollX;break;case"bottom":l=e.top+e.height+10+window.scrollY,i=e.left-t.value.width/2+e.width/2+window.scrollX;break;case"bottom-start":l=e.top+e.height+10+window.scrollY,i=e.left+window.scrollX;break;case"bottom-end":l=e.top+e.height+10+window.scrollY,i=e.left+e.width-t.value.width+window.scrollX;break}return{position:"absolute",top:`${l}px`,left:`${i}px`}}),E=()=>{g.value&&(t.value=g.value.getBoundingClientRect())},z=a=>{g.value&&!g.value.contains(a.target)&&!c.value.contains(a.target)&&P()};return o.onMounted(()=>{window.addEventListener("resize",E),window.addEventListener("click",z),c.value&&(y.value=new MutationObserver(()=>{h.value&&Y()}),y.value.observe(c.value,{attributes:!0,childList:!0,subtree:!0,characterData:!0}))}),o.onUnmounted(()=>{h.value=!1,b.value=!1,window.removeEventListener("resize",E),window.removeEventListener("click",z),y.value&&(y.value.disconnect(),y.value=null)}),(a,e)=>(o.openBlock(),o.createElementBlock("div",M,[o.createElementVNode("span",{class:"popover-trigger",ref_key:"triggerRef",ref:c,onClick:D,onMouseenter:H,onMouseleave:j},[o.renderSlot(a.$slots,"reference",{},void 0,!0)],544),(o.openBlock(),o.createBlock(o.Teleport,{to:s.appendTo},[o.createVNode(o.Transition,{name:"popoverfade"},{default:o.withCtx(()=>[h.value?(o.openBlock(),o.createElementBlock("div",{key:0,class:o.normalizeClass(["popover",[s.popperClass,{"dark-mode":s.darkMode}]]),onMouseleave:W,onMouseenter:q,style:o.normalizeStyle([{zIndex:s.zIndex,width:_(n.width)?n.width+"px":n.width},U.value]),ref_key:"popoverRef",ref:g},[o.createElementVNode("div",{class:o.normalizeClass(["popover-arrow","popover-arrow__"+r.value]),style:o.normalizeStyle(A.value)},null,6),o.createElementVNode("div",O,[s.title?(o.openBlock(),o.createElementBlock("div",V,o.toDisplayString(s.title),1)):o.createCommentVNode("",!0),a.$slots.default?o.renderSlot(a.$slots,"default",{key:2},void 0,!0):o.renderSlot(a.$slots,"default",{key:1},()=>[o.createTextVNode(o.toDisplayString(s.content),1)],!0)])],38)):o.createCommentVNode("",!0)]),_:3})],8,["to"]))]))}}),F="",N=((s,S)=>{const n=s.__vccOpts||s;for(const[_,h]of S)n[_]=h;return n})($,[["__scopeId","data-v-6d5fdba4"]]),I={install:s=>{s.component("Popover",N)}};p.Popover=N,p.default=I,Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
