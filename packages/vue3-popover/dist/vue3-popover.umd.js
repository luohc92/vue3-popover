(function(h,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(h=typeof globalThis<"u"?globalThis:h||self,t(h.Vue3Popover={},h.Vue))})(this,function(h,t){"use strict";const D={class:"popover-wrapper"},H={class:"popover-content"},j={key:0,class:"popover-title"},W=t.defineComponent({__name:"Popover",props:{placement:String,width:{type:[String,Number],default:200},offset:{type:Number,default:10},title:String,content:String,zIndex:{type:Number,default:1999},trigger:{type:String,default:"click"},popperClass:String,appendTo:{type:String,default:"body"},darkMode:Boolean,disabled:Boolean},emits:["open","close"],setup(u,{expose:T,emit:E}){const i=u,C=l=>typeof l=="number",p=t.ref(!1),N=()=>{p.value=!0,M("open")},y=()=>{p.value=!1,m.value=!1,r.value=i.placement||"bottom",M("close")},R=["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],b=t.ref(),s=t.ref(),a=t.ref(),e=t.ref(),P=t.ref(null),r=t.ref(i.placement||"bottom"),M=E,A=()=>{if(!s.value||!a.value)return;const l=s.value.getBoundingClientRect(),o=window.innerHeight,n=window.innerWidth,S=l.top-a.value.height-10,_=l.bottom+10,B=l.left-a.value.width-10,z=l.right+10,v=w=>{if(!w)return"bottom";const f=l.top<a.value.height,d=l.right+a.value.width>n,k=l.bottom+a.value.height>o,g=l.left<0;switch(w){case"top":if(f)return"bottom";if(g)return"top-end";if(d)return"top-start";break;case"top-start":if(f)return"bottom-start";if(g)return"top-end";break;case"top-end":if(f)return"bottom-end";if(d)return"top-start";break;case"bottom":if(k)return"top";if(g)return"bottom-end";if(d)return"bottom-start";break;case"bottom-start":if(k)return"top-start";if(g||d)return"bottom-end";break;case"bottom-end":if(k)return"top-end";if(g)return"bottom-start";break;case"left":if(g)return"right";if(f)return"left-start";if(k)return"left-end";break;case"left-start":if(g)return"right-start";if(k)return"top-start";break;case"left-end":if(g)return"right-end";if(f)return"left-start";break;case"right":if(d)return"left";if(f)return"right-start";if(k)return"right-end";break;case"right-start":if(d)return"left-start";if(k)return"top-start";break;case"right-end":if(d)return"left-end";if(f)return"right-start";break}return w};switch(r.value){case"top":S<0?r.value="bottom":r.value=v(r.value);break;case"bottom":_+a.value.height>o?r.value="top":r.value=v(r.value);break;case"left":const w=v(r.value);w!==r.value?r.value=w:B<0&&(r.value="right");break;case"right":const f=v(r.value);f!==r.value?r.value=f:z+a.value.width>n&&(r.value="left");break;case"top-start":S<0?r.value="bottom-start":r.value=v(r.value);break;case"top-end":S<0?r.value="bottom-end":r.value=v(r.value);break;case"bottom-start":_+a.value.height>o?r.value="top-start":r.value=v(r.value);break;case"bottom-end":_+a.value.height>o?r.value="top-end":r.value=v(r.value);break;case"left-start":B<0?r.value="right-start":r.value=v(r.value);break;case"left-end":B<0?r.value="right-end":r.value=v(r.value);break;case"right-start":z+a.value.width>n?r.value="left-start":r.value=v(r.value);break;case"right-end":const d=v(r.value);d!==r.value?r.value=d:z+a.value.width>n&&(r.value="left-end");break}},x=()=>{s.value&&(e.value=s.value.getBoundingClientRect()),p.value&&b.value&&(a.value=b.value.getBoundingClientRect(),A())},O=()=>{x()},V=l=>{const o=[];let n=l.parentElement;for(;n;){const{overflow:S,overflowX:_,overflowY:B}=window.getComputedStyle(n);/(auto|scroll|overlay)/.test(S+_+B)&&o.push(n),n=n.parentElement}return o},U=()=>{if(!s.value)return;V(s.value).forEach(o=>{o.addEventListener("scroll",O,!0)})},X=()=>{if(!s.value)return;V(s.value).forEach(o=>{o.removeEventListener("scroll",O,!0)})};t.watch(()=>i.placement,l=>{l&&R.includes(l)&&(r.value=l)},{immediate:!0}),t.watch(()=>p.value,l=>{!l||t.nextTick(()=>{x(),U()})});const Y=()=>{i.trigger!=="click"||i.disabled||(p.value?y():N())},c=t.ref(),F=()=>{i.trigger!=="hover"||i.disabled||(c.value&&clearTimeout(c.value),m.value=!1,N())},m=t.ref(!1),G=()=>{i.trigger!=="hover"||i.disabled||(c.value&&clearTimeout(c.value),c.value=setTimeout(()=>{m.value||y()},300))},J=()=>{i.trigger!=="hover"||i.disabled||(m.value=!1,c.value&&clearTimeout(c.value),c.value=setTimeout(()=>{m.value||y()},300))},K=()=>{m.value=!0,c.value&&clearTimeout(c.value)},Q=t.computed(()=>{if(!s.value||!a.value)return{};let l=0,o=0,n=r.value;switch(R.includes(n)||(n="bottom"),n){case"left":l=a.value.width-5,o=a.value.height/2-5;break;case"left-start":l=a.value.width-5,o=e.value.height/2-5;break;case"left-end":l=a.value.width-5,o=a.value.height-e.value.height/2-5;break;case"right":l=-5,o=a.value.height/2-5;break;case"right-start":l=-5,o=e.value.height/2-5;break;case"right-end":l=-5,o=a.value.height-e.value.height/2-5;break;case"top":l=a.value.width/2-5,o=a.value.height-5;break;case"top-start":l=e.value.width/2-5,o=a.value.height-5;break;case"top-end":l=a.value.width-e.value.width/2-5,o=a.value.height-5;break;case"bottom":l=a.value.width/2-5,o=-5;break;case"bottom-start":l=e.value.width/2-5,o=-5;break;case"bottom-end":l=a.value.width-e.value.width/2-5,o=-5;break}return o>a.value.height&&(o=a.value.height-20),l>a.value.width&&(l=a.value.width-20),{left:`${l}px`,top:`${o}px`}}),Z=t.computed(()=>{if(!s.value||!a.value)return{};let l=r.value;R.includes(l)||(l="bottom");let o=0,n=0;switch(l){case"left":o=e.value.top-a.value.height/2+e.value.height/2,n=e.value.left-a.value.width-i.offset;break;case"left-start":o=e.value.top,n=e.value.left-a.value.width-i.offset;break;case"left-end":o=e.value.top-a.value.height+e.value.height,n=e.value.left-a.value.width-i.offset;break;case"right":o=e.value.top-a.value.height/2+e.value.height/2,n=e.value.left+e.value.width+i.offset;break;case"right-start":o=e.value.top,n=e.value.left+e.value.width+i.offset;break;case"right-end":o=e.value.top-a.value.height+e.value.height,n=e.value.left+e.value.width+i.offset;break;case"top":o=e.value.top-a.value.height-i.offset,n=e.value.left-a.value.width/2+e.value.width/2;break;case"top-start":o=e.value.top-a.value.height-i.offset,n=e.value.left;break;case"top-end":o=e.value.top-a.value.height-i.offset,n=e.value.left+e.value.width-a.value.width;break;case"bottom":o=e.value.top+e.value.height+i.offset,n=e.value.left-a.value.width/2+e.value.width/2;break;case"bottom-start":o=e.value.top+e.value.height+i.offset,n=e.value.left;break;case"bottom-end":o=e.value.top+e.value.height+i.offset,n=e.value.left+e.value.width-a.value.width;break}return{top:`${o}px`,left:`${n}px`}}),$=()=>{e.value&&(e.value=s.value.getBoundingClientRect()),b.value&&(a.value=b.value.getBoundingClientRect())},I=l=>{b.value&&!b.value.contains(l.target)&&!s.value.contains(l.target)&&y()};return t.onMounted(()=>{window.addEventListener("resize",$),window.addEventListener("click",I),s.value&&(P.value=new MutationObserver(()=>{p.value&&x()}),P.value.observe(s.value,{attributes:!0,childList:!0,subtree:!0,characterData:!0}))}),t.onUnmounted(()=>{p.value=!1,m.value=!1,window.removeEventListener("resize",$),window.removeEventListener("click",I),X(),P.value&&(P.value.disconnect(),P.value=null)}),T({open:N,close:y}),(l,o)=>(t.openBlock(),t.createElementBlock("div",D,[t.createElementVNode("span",{class:"popover-trigger",ref_key:"triggerRef",ref:s,onClick:Y,onMouseenter:F,onMouseleave:G},[t.renderSlot(l.$slots,"reference",{},void 0,!0)],544),(t.openBlock(),t.createBlock(t.Teleport,{to:u.appendTo},[t.createVNode(t.Transition,{name:"popoverfade"},{default:t.withCtx(()=>[p.value?(t.openBlock(),t.createElementBlock("div",{key:0,class:t.normalizeClass(["popover",[u.popperClass,{"dark-mode":u.darkMode}]]),onMouseleave:J,onMouseenter:K,style:t.normalizeStyle([{zIndex:u.zIndex,width:C(i.width)?i.width+"px":i.width},Z.value]),ref_key:"popoverRef",ref:b},[t.createElementVNode("div",{class:t.normalizeClass(["popover-arrow","popover-arrow__"+r.value]),style:t.normalizeStyle(Q.value)},null,6),t.createElementVNode("div",H,[u.title?(t.openBlock(),t.createElementBlock("div",j,t.toDisplayString(u.title),1)):t.createCommentVNode("",!0),l.$slots.default?t.renderSlot(l.$slots,"default",{key:2},void 0,!0):t.renderSlot(l.$slots,"default",{key:1},()=>[t.createTextVNode(t.toDisplayString(u.content),1)],!0)])],38)):t.createCommentVNode("",!0)]),_:3})],8,["to"]))]))}}),ee="",L=((u,T)=>{const E=u.__vccOpts||u;for(const[i,C]of T)E[i]=C;return E})(W,[["__scopeId","data-v-14a94e9e"]]),q={install:u=>{u.component("Popover",L)}};h.Popover=L,h.default=q,Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
