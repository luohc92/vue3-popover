(function(p,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(p=typeof globalThis<"u"?globalThis:p||self,t(p.Vue3Popover={},p.Vue))})(this,function(p,t){"use strict";const I={class:"popover-wrapper"},D={class:"popover-content"},H={key:0,class:"popover-title"},j=t.defineComponent({__name:"Popover",props:{placement:String,width:{type:[String,Number],default:200},offset:{type:Number,default:10},title:String,content:String,zIndex:{type:Number,default:1999},trigger:{type:String,default:"click"},popperClass:String,appendTo:{type:String,default:"body"},darkMode:Boolean,disabled:Boolean},emits:["open","close"],setup(u,{emit:E}){const i=u,T=l=>typeof l=="number",c=t.ref(!1),z=()=>{c.value=!0,L("open")},B=()=>{c.value=!1,m.value=!1,r.value=i.placement||"bottom",L("close")},C=["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],b=t.ref(),s=t.ref(),a=t.ref(),e=t.ref(),y=t.ref(null),r=t.ref(i.placement||"bottom"),L=E,q=()=>{if(!s.value||!a.value)return;const l=s.value.getBoundingClientRect(),o=window.innerHeight,n=window.innerWidth,P=l.top-a.value.height-10,S=l.bottom+10,_=l.left-a.value.width-10,R=l.right+10,v=w=>{if(!w)return"bottom";const d=l.top<a.value.height,h=l.right+a.value.width>n,k=l.bottom+a.value.height>o,g=l.left<0;switch(w){case"top":if(d)return"bottom";if(g)return"top-end";if(h)return"top-start";break;case"top-start":if(d)return"bottom-start";if(g)return"top-end";break;case"top-end":if(d)return"bottom-end";if(h)return"top-start";break;case"bottom":if(k)return"top";if(g)return"bottom-end";if(h)return"bottom-start";break;case"bottom-start":if(k)return"top-start";if(g||h)return"bottom-end";break;case"bottom-end":if(k)return"top-end";if(g)return"bottom-start";break;case"left":if(g)return"right";if(d)return"left-start";if(k)return"left-end";break;case"left-start":if(g)return"right-start";if(k)return"top-start";break;case"left-end":if(g)return"right-end";if(d)return"left-start";break;case"right":if(h)return"left";if(d)return"right-start";if(k)return"right-end";break;case"right-start":if(h)return"left-start";if(k)return"top-start";break;case"right-end":if(h)return"left-end";if(d)return"right-start";break}return w};switch(r.value){case"top":P<0?r.value="bottom":r.value=v(r.value);break;case"bottom":S+a.value.height>o?r.value="top":r.value=v(r.value);break;case"left":const w=v(r.value);w!==r.value?r.value=w:_<0&&(r.value="right");break;case"right":const d=v(r.value);d!==r.value?r.value=d:R+a.value.width>n&&(r.value="left");break;case"top-start":P<0?r.value="bottom-start":r.value=v(r.value);break;case"top-end":P<0?r.value="bottom-end":r.value=v(r.value);break;case"bottom-start":S+a.value.height>o?r.value="top-start":r.value=v(r.value);break;case"bottom-end":S+a.value.height>o?r.value="top-end":r.value=v(r.value);break;case"left-start":_<0?r.value="right-start":r.value=v(r.value);break;case"left-end":_<0?r.value="right-end":r.value=v(r.value);break;case"right-start":R+a.value.width>n?r.value="left-start":r.value=v(r.value);break;case"right-end":const h=v(r.value);h!==r.value?r.value=h:R+a.value.width>n&&(r.value="left-end");break}},N=()=>{e.value=s.value.getBoundingClientRect(),c.value&&b.value&&(a.value=b.value.getBoundingClientRect(),q())},M=()=>{N()},O=l=>{const o=[];let n=l.parentElement;for(;n;){const{overflow:P,overflowX:S,overflowY:_}=window.getComputedStyle(n);/(auto|scroll|overlay)/.test(P+S+_)&&o.push(n),n=n.parentElement}return o},A=()=>{if(!s.value)return;O(s.value).forEach(o=>{o.addEventListener("scroll",M,!0)})},U=()=>{if(!s.value)return;O(s.value).forEach(o=>{o.removeEventListener("scroll",M,!0)})};t.watch(()=>i.placement,l=>{l&&C.includes(l)&&(r.value=l)},{immediate:!0}),t.watch(()=>c.value,l=>{!l||t.nextTick(()=>{N(),A()})});const X=()=>{i.trigger!=="click"||i.disabled||(c.value?B():z())},f=t.ref(),Y=()=>{i.trigger!=="hover"||i.disabled||(f.value&&clearTimeout(f.value),m.value=!1,z())},m=t.ref(!1),F=()=>{i.trigger!=="hover"||i.disabled||(f.value&&clearTimeout(f.value),f.value=setTimeout(()=>{m.value||B()},300))},G=()=>{i.trigger!=="hover"||i.disabled||(m.value=!1,f.value&&clearTimeout(f.value),f.value=setTimeout(()=>{m.value||B()},300))},J=()=>{m.value=!0,f.value&&clearTimeout(f.value)},K=t.computed(()=>{if(!s.value||!a.value)return{};let l=0,o=0,n=r.value;switch(C.includes(n)||(n="bottom"),n){case"left":l=a.value.width-5,o=a.value.height/2-5;break;case"left-start":l=a.value.width-5,o=e.value.height/2-5;break;case"left-end":l=a.value.width-5,o=a.value.height-e.value.height/2-5;break;case"right":l=-5,o=a.value.height/2-5;break;case"right-start":l=-5,o=e.value.height/2-5;break;case"right-end":l=-5,o=a.value.height-e.value.height/2-5;break;case"top":l=a.value.width/2-5,o=a.value.height-5;break;case"top-start":l=e.value.width/2-5,o=a.value.height-5;break;case"top-end":l=a.value.width-e.value.width/2-5,o=a.value.height-5;break;case"bottom":l=a.value.width/2-5,o=-5;break;case"bottom-start":l=e.value.width/2-5,o=-5;break;case"bottom-end":l=a.value.width-e.value.width/2-5,o=-5;break}return o>a.value.height&&(o=a.value.height-20),l>a.value.width&&(l=a.value.width-20),{left:`${l}px`,top:`${o}px`}}),Q=t.computed(()=>{if(!s.value||!a.value)return{};let l=r.value;C.includes(l)||(l="bottom");let o=0,n=0;switch(l){case"left":o=e.value.top-a.value.height/2+e.value.height/2,n=e.value.left-a.value.width-i.offset;break;case"left-start":o=e.value.top,n=e.value.left-a.value.width-i.offset;break;case"left-end":o=e.value.top-a.value.height+e.value.height,n=e.value.left-a.value.width-i.offset;break;case"right":o=e.value.top-a.value.height/2+e.value.height/2,n=e.value.left+e.value.width+i.offset;break;case"right-start":o=e.value.top,n=e.value.left+e.value.width+i.offset;break;case"right-end":o=e.value.top-a.value.height+e.value.height,n=e.value.left+e.value.width+i.offset;break;case"top":o=e.value.top-a.value.height-i.offset,n=e.value.left-a.value.width/2+e.value.width/2;break;case"top-start":o=e.value.top-a.value.height-i.offset,n=e.value.left;break;case"top-end":o=e.value.top-a.value.height-i.offset,n=e.value.left+e.value.width-a.value.width;break;case"bottom":o=e.value.top+e.value.height+i.offset,n=e.value.left-a.value.width/2+e.value.width/2;break;case"bottom-start":o=e.value.top+e.value.height+i.offset,n=e.value.left;break;case"bottom-end":o=e.value.top+e.value.height+i.offset,n=e.value.left+e.value.width-a.value.width;break}return{top:`${o}px`,left:`${n}px`}}),V=()=>{e.value&&(e.value=s.value.getBoundingClientRect()),b.value&&(a.value=b.value.getBoundingClientRect())},$=l=>{b.value&&!b.value.contains(l.target)&&!s.value.contains(l.target)&&B()};return t.onMounted(()=>{window.addEventListener("resize",V),window.addEventListener("click",$),s.value&&(y.value=new MutationObserver(()=>{c.value&&N()}),y.value.observe(s.value,{attributes:!0,childList:!0,subtree:!0,characterData:!0}))}),t.onUnmounted(()=>{c.value=!1,m.value=!1,window.removeEventListener("resize",V),window.removeEventListener("click",$),U(),y.value&&(y.value.disconnect(),y.value=null)}),(l,o)=>(t.openBlock(),t.createElementBlock("div",I,[t.createElementVNode("span",{class:"popover-trigger",ref_key:"triggerRef",ref:s,onClick:X,onMouseenter:Y,onMouseleave:F},[t.renderSlot(l.$slots,"reference",{},void 0,!0)],544),(t.openBlock(),t.createBlock(t.Teleport,{to:u.appendTo},[t.createVNode(t.Transition,{name:"popoverfade"},{default:t.withCtx(()=>[c.value?(t.openBlock(),t.createElementBlock("div",{key:0,class:t.normalizeClass(["popover",[u.popperClass,{"dark-mode":u.darkMode}]]),onMouseleave:G,onMouseenter:J,style:t.normalizeStyle([{zIndex:u.zIndex,width:T(i.width)?i.width+"px":i.width},Q.value]),ref_key:"popoverRef",ref:b},[t.createElementVNode("div",{class:t.normalizeClass(["popover-arrow","popover-arrow__"+r.value]),style:t.normalizeStyle(K.value)},null,6),t.createElementVNode("div",D,[u.title?(t.openBlock(),t.createElementBlock("div",H,t.toDisplayString(u.title),1)):t.createCommentVNode("",!0),l.$slots.default?t.renderSlot(l.$slots,"default",{key:2},void 0,!0):t.renderSlot(l.$slots,"default",{key:1},()=>[t.createTextVNode(t.toDisplayString(u.content),1)],!0)])],38)):t.createCommentVNode("",!0)]),_:3})],8,["to"]))]))}}),Z="",x=((u,E)=>{const i=u.__vccOpts||u;for(const[T,c]of E)i[T]=c;return i})(j,[["__scopeId","data-v-d51a0833"]]),W={install:u=>{u.component("Popover",x)}};p.Popover=x,p.default=W,Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
